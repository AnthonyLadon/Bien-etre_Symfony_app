{% extends 'base.html.twig' %}

{% block title %}
	{{partenaire.nom}}
{% endblock %}

{% block titreh1 %}
    {{partenaire.nom}}
{% endblock %}

{% block searchForm %}
	{% embed "_searchFormToggle.html.twig" %}{% endembed %}
{% endblock %}

{% block body %}
  <article>
      <div class="partenaire-avatar">
      {% if partenaire.images[0] is defined %}
            <img class="prestaire_img" src="{{ asset('images/avatars/' ~ partenaire.images[0]) }}" alt="photo de profil du prestataire"/>
      {% else %}
            <img class="prestaire_img" src="{{ asset('images/avatars/blank_profile.webp') }}" alt="photo de profil du prestataire"/>
      {% endif %}
    </div>
    {% for pr in partenaire.promotion %}
      {%  if pr.affichageDe|date("d/m/Y") <= "now"|date("d/m/Y") and pr.affichageJusque|date("d/m/Y") >= "now"|date("d/m/Y") %}
      <div>
        <p><span>Promotion!</span> Dans la catégorie "{{pr.categorieService}}", du: {{pr.debut|date("d/m/Y") }} au: {{pr.fin|date("d/m/Y")}}</p>
        <p>{{ pr.nom }}</p>
        {{ pr.description }}
      </div>
      {% endif %}
    {% endfor %}
    {% if partenaire.proposer is not empty %}
      <h3>Mes catégories de service</h3>
      <div class="prestataire-detail-services-list">
        <ul>
          {% for service in partenaire.proposer %}
          <li><a href="{{path('detailService',{id : service.id} )}}">
          {{ service.nom}}
          </a>
          {% endfor %}
        </ul>
      </div>
    {% else %}
      <div class="prestataire-detail-services-list">
        <h3>Je n'ai pas encore de catégorie de service</h3>
      </div>
    {% endif %}
    {% if partenaire.stage is not empty %}
    <h3>Les stages que je propose actuellement</h3>
    <ul>
        {% for st in partenaire.stage %}
          {# test si le stage est dans sa periode d'affichage. Si oui -> Affichage #}
          {% if st.affichageDe|date("d/m/Y") <= "now"|date("d/m/Y") and st.affichageJusque|date("d/m/Y") >= "now"|date("d/m/Y") %}
            <li>
              <a href="{{path('detailStage',{id : st.id} )}}">{{st.nom}}</a>
            </li>
          {% endif %}
        {% endfor %}
    </ul>
    {% else %}
      <h3>Je ne propose pas encore de stage</h3>
    {% endif %}

    <div class="prestataire-detail-contact">
      <p>
        Mon site web:
        <a href="#">{{ partenaire.siteWeb }}</a>
      </p>
      <p>
        Tél:
        {{ partenaire.tel }}
      </p>
      <p>
        N° TVA:
        {{ partenaire.tvaNum }}
      </p>
    </div>
    {# Carrousel photos prestataire #}
    <div class="gallery">
        {% for img in partenaire.images %}
        {# test pour ne pas afficher la photo de profil ici #}
          {% if img != partenaire.images[0] %}
            <img class="prestaire_img" src="{{ asset('images/avatars/' ~ img) }}" alt="photo du prestataire"/>
          {% endif %}
        {% endfor %}
        <img src="https://images.pexels.com/photos/13921689/pexels-photo-13921689.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" />
        <img src="https://images.pexels.com/photos/14577737/pexels-photo-14577737.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" />
        <img src="https://images.pexels.com/photos/14686959/pexels-photo-14686959.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" />
        <img src="https://images.pexels.com/photos/12620000/pexels-photo-12620000.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" />
    </div>
    </div>
    <p>Pour me trouver: </p>
    <p>{{ partenaire.utilisateur.adresseRue }} {{ partenaire.utilisateur.adresseNum }}</p>
    <p>{{ partenaire.utilisateur.codePostal }} {{ partenaire.utilisateur.commune }}</p>
    <div id="map"></div>
    <div>
      <p>Commentaires</p>
      {% for com in partenaire.commentaires %}
        <div>
          <p>{{com.titre}}</p>
          <p>{{com.contenu}}</p>
          <p>Le {{com.dateEncodage| date('d/m/Y')}} par: {{com.internaute }}</p>
        </div>
      {% endfor %}
    </div>
  </article>
{% endblock %}
